---
- name: install_ngnix
  hosts: demo
  gather_facts: false
  become: true
  tasks:
    - name: Add epel-release repo
      yum:
        name: "epel-release"
        state: "present"
    - name: Install nginx
      yum:
        name: "nginx"
        state: "present"
    - name: Insert Index Page
      copy:
        src: "index.html"
        dest: "/usr/share/nginx/html/index.html"
    - name: Copy confog file
      copy:
        src: "nginx.conf"
        dest: "/etc/nginx/nginx.conf"
    - name: Copy Certificates
      copy:
        src: "{{ item }}"
        dest: "/etc/pki/nginx/"
      with_fileglob:
        - "demo*"
    - name: Start NGiNX
      service:
        name: "nginx"
        state: "started"
